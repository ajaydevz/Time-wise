{% extends 'layout/base.html' %}
{% load static %}

<!-- Start Header / Navigation -->
{% block bootstraplink %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row d-flex justify-content-center">
        <!-- Main Product Image -->
        <div class="col-sm-6 mx-auto vertical-align">
            <div class="col-md-6">
                <!-- Main Product Image -->
                <img src="/media/{{ variant.image1 }}" onclick="changeImage()" id="main-image" class="img-fluid" width="140%">
            </div>
            <div class="d-flex flex-row col-md-6">
                <!-- Small Images -->
                <div class="small-image mt-3 mb-5">
                    <img src="/media/{{ variant.image2 }}" id="image1" alt="Small Image 1" class="img-fluid small-img" style="width: 100%;">
                </div>
                <div class="small-image mt-3 mb-2">
                    <img src="/media/{{ variant.image3 }}" alt="Small Image 2" class="img-fluid small-img" style="width: 100%;">
                </div>
                <div class="small-image mt-3 mb-2">
                    <img src="/media/{{ variant.image3 }}" alt="Small Image 3" class="img-fluid small-img" style="width: 100%;">
                </div>
            </div>
        </div>

        <!-- Product Details -->
        <div class="col-sm-6 mb-5">
            <h2 style="color: black; font-weight: bolder">{{ variant.product.product_name }}</h2>
            <div class="d-flex align-items-center mt-3">
                <h4><strong>Rs.</strong></h4>
                <h4 class="" id="price" style="color: red">{{ variant.selling_price }}</h4>
                {% if variant.selling_price < variant.actual_price %}
                    <h6><del style="color: rgb(86, 85, 85); margin-left: 10px;">{{ variant.actual_price }}</del></h6>
                {% endif %}
            </div>

            {% if messages %}
                <div class="text-danger d-flex justify-content-evenly mt-2">
                    {% for message in messages %}
                        <h6>{{ message }}</h6>
                    {% endfor %}
                </div>
            {% endif %}

            {% if variant.stock == 0 %}
                <!-- Out of Stock -->
                <button class="btn btn-danger-sm mb-3" disabled>
                    Out of stock
                </button>
                <p class="sorry_msg">
                    Sorry for this inconvenience
                </p>
            {% else %}
                <!-- In Stock -->
                <div class="d-flex mt-3">
                </div>
                <!-- Buttons -->
                <div class="mt-3">
                    <a href="{% url 'add_cart' product_id=variant.id %}">
                        <button class="btn btn-primary" class="btn btn-sm button-addtocart">Add to Cart</button>
                    </a>
                    <a href="{% url 'add_to_wishlist' product_id=variant.id %}">
                        <button class="btn" id="wishlist">Add to wishlist</button>
                    </a>
                </div>
                <!-- Add your "Add to Cart" button or any other relevant content here -->
            {% endif %}

            <h5 class="mt-4" style="color: brown">About this Item :</h5>
            <p>{{ variant.product.description }}</p>
        </div>
    </div>
</div>

<script>
    function changeImage() {
        // Get references to the main image and the small image
        const mainImage = document.getElementById('main-image');
        const smallImage = document.getElementById('image1');

        // Store the src attributes of the images
        const mainImageSrc = mainImage.src;
        const smallImageSrc = smallImage.src;

        // Swap the src attributes
        mainImage.src = smallImageSrc;
        smallImage.src = mainImageSrc;
    }
</script>

{% endblock %}

{% block script %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>

<script>
    $(document).ready(function () {
        // Attach a click event handler to all small images
        $(".small-img").click(function () {
            // Get the source of the clicked small image
            var newSrc = $(this).attr("src");

            // Set the source of the main product image to the clicked small image source
            $("#image_1").attr("src", newSrc);

            // Optionally, you can animate the image size change for a smoother transition
            $("#image_1").animate({
                width: "140%"  // Adjust the size as needed
            }, 500);  // You can adjust the animation duration (in milliseconds)

            // Reset the size of other small images
            $(".small-img").css("width", "100%");

            // Set the size of the clicked small image to a larger size
            $(this).css("width", "140%");  // Adjust the size as needed
        });

        // Other code in your script...
    });
</script>
{% endblock %}
